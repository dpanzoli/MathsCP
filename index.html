<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="config.js"></script>
<script src="phaser.min.js"></script>
<script src="menu.js"></script>
<script src="nombres.js"></script>
<script src="succes.js"></script>
<style>
	.ui.container {
		padding:10px;
	}
	#phaserGame {
		width: 800px;
		height: 600px;
		margin: auto;
	}
	#showAnalytics {
		position: absolute;
	}
</style>
<body class="ui container">
<button id="showAnalytics" class="ui button">
	Stats
</button>
<div id="phaserGame"></div>
<div class="ui modal">
  <i class="close icon"></i>
  <div class="header">Analytics</div>
  <div class="content" id="analytics">
	<div id="graphe1"></div>  
  </div>
  <div class="actions">
    <div class="ui black deny button">
      Fermer
    </div>
  </div>
</div>

<div id="analytics">
<!--table>
	<tr><th>timestamp</th><tr>
</table-->
</div>

<script language="javascript">

var game = new Phaser.Game(800, 600, Phaser.AUTO, 'phaserGame');

game.state.add('menu', menu);
game.state.add('nombres', nombres);
game.state.add('succes', succes);

game.state.start('menu');

</script>
<script>

	$(showAnalytics).click(function() {
		$('.ui.modal').modal('show');
	});

</script>
<script>

	var points = {
		x:[],
		y:[],
		mode: 'markers'
	}

	$.ajax({
		method: 'GET',
		url: 'http://davidpanzo.hd.free.fr:8080/all',
		datatype: 'json',
		success: function(json) {
		
			//remplissage des points à partir du retour json
			json.forEach(function (p) {
				points.x.push(p.nombre);
				points.y.push(p.temps);
			});
		
			var data = [ points ];

			var layout = {
			  xaxis: {
				range: [ 0, 100 ],
				title: 'nombre à trouver [10,99]'
				
			  },
			  yaxis: {
				range: [0, 10],
				title: 'nombre trouvé en ... secondes'
			  },
			  title:'Temps passé par nombre'
			};
			
			Plotly.newPlot('graphe1', data, layout);
		},
		error: function(xh, sts, err) {
			console.log(sts+":"+err);
		}
	});

</script>
</body>
</html>
